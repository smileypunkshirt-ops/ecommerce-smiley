import{u as B,_ as D,a as H}from"./zlUgwu3J.js";import{l as j,f as Q,s as N,m as T,n as W,g as R,c as i,a,b as h,p as w,u as r,F as G,j as J,o as n,q as K,w as I,e as O,i as U,t as m}from"./CxzPJ4Pb.js";import{u as X}from"./B8ZhceQh.js";const Y=j("catalog",{state:()=>({items:[],loading:!1,error:null}),actions:{async fetchProducts(){if(this.items.length)return this.items;this.loading=!0,this.error=null;try{const y=await $fetch("/api/catalog/products");return this.items=y.items,this.items}catch(y){return this.error=y instanceof Error?y.message:"Failed to load products",[]}finally{this.loading=!1}}}}),Z={class:"page"},tt={class:"container"},st={key:0},et={key:1},at={key:2,class:"products-grid"},ot=["src","alt"],it={key:1},nt={class:"card-body"},rt={class:"price"},ct={key:0},lt={key:1},dt={class:"hero-subtitle"},ut={key:0,class:"card-qty"},mt={class:"card-qty-row"},yt={class:"qty-controls"},pt=["disabled","onClick"],bt={class:"qty-value"},ht=["disabled","onClick"],_t=["disabled","onClick"],gt=["disabled","onClick"],ft={key:2,class:"hero-subtitle"},qt=Q({__name:"index",async setup(y){let _,g;X({title:"Smiley Punk | Playeras"});const f=Y(),d=B(),{items:x,loading:P,error:$}=N(f),{itemCount:E,loading:b,error:v,items:S}=N(d);[_,g]=T(()=>H("catalog-products",()=>f.fetchProducts())),await _,g(),W(()=>{d.fetchCart()});const V=async e=>{await d.addItem(e,1)},F=(e,t=1)=>{if(typeof e=="number")return Number.isFinite(e)&&e>0?e:t;if(typeof e=="string"){const o=Number(e);return Number.isFinite(o)&&o>0?o:t}if(e&&typeof e=="object"){const o=e,c=[o.value,o.qty,o.quantity];for(const s of c){const l=Number(s);if(Number.isFinite(l)&&l>0)return l}}return t},z=R(()=>{const e=new Map;return S.value.forEach((t,o)=>{const c=t.product_id??t.productId??t.id,s=Number(c);if(!Number.isFinite(s))return;const l=F(t.quantity??t.qty??t.count??1,1),p=String(t.key||t.item_key||t.cart_item_key||t.id||t.product_id||o),L=t.variation_id??t.variationId,C=Number(L),M=t.variation||t.attributes,q=e.get(s);q?q.quantity+=l:e.set(s,{quantity:l,key:p,variationId:Number.isFinite(C)?C:void 0,variation:M})}),e}),u=e=>z.value.get(e),k=async(e,t,o)=>{if(!t)return;if(o>0){await d.addItem(e,o,t.variationId,t.variation);return}const c=Math.max(0,t.quantity+o);if(c<1){t.key&&await d.removeItem(t.key);return}t.key&&await d.updateItem(t.key,c)},A=async e=>{const t=u(e);t?.key&&await d.removeItem(t.key)};return(e,t)=>{const o=D,c=O;return n(),i("div",Z,[a("div",tt,[h(o,{"item-count":r(E)},null,8,["item-count"]),t[3]||(t[3]=w('<section class="hero"><div><span class="badge">Nuevos drops</span><h1 class="hero-title">Playeras que hablan fuerte</h1><p class="hero-subtitle"> Coleccion corta, tonos clasicos y acabados limpios. Compra rapido y agrega al carrito sin salirte. </p><div class="hero-actions"><button class="btn btn-primary" type="button">Ver coleccion</button><button class="btn btn-secondary" type="button">Como funciona</button></div></div><div class="hero-panel"><h3>Lo esencial en un vistazo</h3><ul><li>Stock real directo de WooCommerce</li><li>Carrito persistente con CoCart</li><li>Checkout listo para integrar</li></ul></div></section>',1)),a("section",null,[t[2]||(t[2]=a("h2",{class:"section-title"},"Playeras destacadas",-1)),r(P)?(n(),i("p",st,"Cargando catalogo...")):r($)?(n(),i("p",et,"No se pudo cargar el catalogo.")):(n(),i("div",at,[(n(!0),i(G,null,J(r(x),(s,l)=>(n(),i("article",{key:s.id,class:"card",style:K({animationDelay:`${l*80}ms`})},[h(c,{class:"card-image",to:`/products/${s.slug}`},{default:I(()=>[s.image?(n(),i("img",{key:0,src:s.image,alt:s.imageAlt},null,8,ot)):(n(),i("span",it,"Sin imagen"))]),_:2},1032,["to"]),a("div",nt,[h(c,{to:`/products/${s.slug}`},{default:I(()=>[a("strong",null,m(s.name),1)]),_:2},1032,["to"]),a("span",rt,[s.salePrice?(n(),i("span",ct,"$ "+m(s.salePrice),1)):(n(),i("span",lt,"$ "+m(s.price||s.regularPrice),1))]),a("p",dt,m(s.shortDescription||"Playera clasica, lista para combinar."),1),u(s.id)?(n(),i("div",ut,[t[1]||(t[1]=a("span",{class:"qty-label"},"Cantidad",-1)),a("div",mt,[a("div",yt,[a("button",{class:"qty-btn",type:"button",disabled:r(b)||u(s.id).quantity<=1,onClick:p=>k(s.id,u(s.id),-1)}," - ",8,pt),a("span",bt,m(u(s.id).quantity),1),a("button",{class:"qty-btn",type:"button",disabled:r(b),onClick:p=>k(s.id,u(s.id),1)}," + ",8,ht)]),a("button",{class:"icon-btn",type:"button",disabled:r(b),"aria-label":"Eliminar del carrito",onClick:p=>A(s.id)},[...t[0]||(t[0]=[a("svg",{viewBox:"0 0 24 24","aria-hidden":"true"},[a("path",{fill:"currentColor",d:"M9 3h6l1 2h4v2H4V5h4l1-2zm1 6h2v8h-2V9zm4 0h2v8h-2V9zM7 9h2v8H7V9z"})],-1)])],8,_t)])])):(n(),i("button",{key:1,class:"btn btn-primary",type:"button",disabled:r(b),onClick:p=>V(s.id)}," Agregar al carrito ",8,gt)),r(v)?(n(),i("p",ft,m(r(v)),1)):U("",!0)])],4))),128))]))]),t[4]||(t[4]=w('<section class="benefits"><div class="benefit"><strong>Envio rapido</strong><p class="hero-subtitle">Entrega nacional con seguimiento incluido.</p></div><div class="benefit"><strong>Calidad premium</strong><p class="hero-subtitle">Algodon suave y acabado resistente.</p></div><div class="benefit"><strong>Pago seguro</strong><p class="hero-subtitle">Checkout directo con WooCommerce.</p></div></section><section class="footer-cta"><div><h2 class="section-title">Listo para armar tu outfit?</h2><p class="hero-subtitle">Explora la coleccion completa y arma tu carrito.</p></div><button class="btn btn-primary" type="button">Explorar playeras</button></section>',2))])])}}});export{qt as default};
