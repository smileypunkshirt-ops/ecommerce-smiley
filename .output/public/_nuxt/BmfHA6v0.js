import{u as B,_ as F,a as $}from"./zlUgwu3J.js";import{f as z,B as D,s as E,g as h,m as H,n as M,c as r,a as o,b as k,i as m,u as s,w as R,t as u,e as T,o as n,d as L}from"./CxzPJ4Pb.js";import{u as j}from"./B8ZhceQh.js";const Q={class:"page"},G={class:"container"},J={class:"pdp-layout"},K={class:"pdp-back-row"},O={class:"pdp-media"},U={class:"pdp-image"},W=["src","alt"],X={key:1},Y={class:"pdp-info"},Z={key:0},tt={key:1},et={key:2},st={class:"hero-title"},ot={class:"pdp-price"},at={class:"hero-subtitle"},it={class:"pdp-actions"},rt=["disabled"],nt=["disabled"],ct={key:0,class:"hero-subtitle"},dt={key:0,class:"pdp-details"},ut={class:"hero-subtitle"},yt=z({__name:"[slug]",async setup(lt){let l,f;const C=D(),p=B(),{itemCount:N,loading:g,error:b,items:w}=E(p),v=h(()=>String(C.params.slug||"")),{data:e,pending:x,error:P}=([l,f]=H(()=>$("product-detail",()=>$fetch(`/api/catalog/products/${v.value}`),{watch:[v]})),l=await l,f(),l);M(()=>{p.fetchCart()});const S=h(()=>e.value?e.value.salePrice||e.value.price||e.value.regularPrice:""),V=async()=>{e.value&&await p.addItem(e.value.id,1)},I=(i,a=1)=>{if(typeof i=="number")return Number.isFinite(i)&&i>0?i:a;if(typeof i=="string"){const t=Number(i);return Number.isFinite(t)&&t>0?t:a}if(i&&typeof i=="object"){const t=i,c=[t.value,t.qty,t.quantity];for(const _ of c){const d=Number(_);if(Number.isFinite(d)&&d>0)return d}}return a},y=h(()=>{if(!e.value)return null;const i=e.value.id,a=w.value;for(const t of a){const c=t.product_id??t.productId??t.id,_=Number(c);if(!Number.isFinite(_)||_!==i)continue;const d=String(t.key||t.item_key||t.cart_item_key||t.id||t.product_id),A=I(t.quantity??t.qty??t.count??1,1);return{key:d,quantity:A}}return null}),q=async()=>{y.value?.key&&await p.removeItem(y.value.key)};return j(()=>({title:e.value?`${e.value.name} | Smiley Punk`:"Producto"})),(i,a)=>{const t=F,c=T;return n(),r("div",Q,[o("div",G,[k(t,{"item-count":s(N)},null,8,["item-count"]),o("section",J,[o("div",K,[k(c,{class:"pdp-back",to:"/"},{default:R(()=>[...a[0]||(a[0]=[L("Regresar al catalogo",-1)])]),_:1})]),o("div",O,[o("div",U,[s(e)?.image?(n(),r("img",{key:0,src:s(e).image,alt:s(e).imageAlt},null,8,W)):(n(),r("span",X,"Sin imagen"))])]),o("div",Y,[s(x)?(n(),r("p",Z,"Cargando producto...")):s(P)?(n(),r("p",tt,"No se pudo cargar el producto.")):s(e)?(n(),r("div",et,[a[2]||(a[2]=o("span",{class:"badge"},"Playera Smiley",-1)),o("h1",st,u(s(e).name),1),o("p",ot,"$ "+u(s(S)),1),o("p",at,u(s(e).shortDescription||"Playera clasica con corte regular."),1),o("div",it,[o("button",{class:"btn btn-primary",type:"button",disabled:s(g),onClick:V}," Agregar al carrito ",8,rt),s(y)?(n(),r("button",{key:0,class:"icon-btn",type:"button",disabled:s(g),"aria-label":"Eliminar del carrito",onClick:q},[...a[1]||(a[1]=[o("svg",{viewBox:"0 0 24 24","aria-hidden":"true"},[o("path",{fill:"currentColor",d:"M9 3h6l1 2h4v2H4V5h4l1-2zm1 6h2v8h-2V9zm4 0h2v8h-2V9zM7 9h2v8H7V9z"})],-1)])],8,nt)):m("",!0)]),s(b)?(n(),r("p",ct,u(s(b)),1)):m("",!0)])):m("",!0)])]),s(e)?(n(),r("section",dt,[a[3]||(a[3]=o("h2",{class:"section-title"},"Descripcion",-1)),o("p",ut,u(s(e).description||"Sin descripcion adicional por ahora."),1)])):m("",!0)])])}}});export{yt as default};
