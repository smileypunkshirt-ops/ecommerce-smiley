{"file":"cart-DoTHzb8_.js","mappings":";;;;;;;;;;;;;;;;;;;;;AAIA,YAAQ;AAAA,MACN,OAAO;AAAA,IAAA,CACR;AAED,UAAM,OAAO,aAAA;AACb,UAAM,EAAE,MAAM,aAAa,OAAO,SAAS,OAAO,UAAA,IAAc,YAAY,IAAI;AAEhF,iBAAa,QAAQ,MAAM,KAAK,UAAA,GAAa,EAAE,QAAQ,OAAO;AAE9D,UAAM,aAAa,SAAiC,EAAE;AAEtD,UAAM,kBAAkB,CAAC,OAAgB,WAAW,MAAM;AACxD,UAAI,OAAO,UAAU,SAAU,QAAO,OAAO,SAAS,KAAK,KAAK,QAAQ,IAAI,QAAQ;AACpF,UAAI,OAAO,UAAU,UAAU;AAC7B,cAAM,SAAS,OAAO,KAAK;AAC3B,eAAO,OAAO,SAAS,MAAM,KAAK,SAAS,IAAI,SAAS;AAAA,MAC1D;AACA,UAAI,SAAS,OAAO,UAAU,UAAU;AACtC,cAAM,SAAS;AACf,cAAM,aAAa,CAAC,OAAO,OAAO,OAAO,KAAK,OAAO,QAAQ;AAC7D,mBAAW,aAAa,YAAY;AAClC,gBAAM,SAAS,OAAO,SAAS;AAC/B,cAAI,OAAO,SAAS,MAAM,KAAK,SAAS,EAAG,QAAO;AAAA,QACpD;AAAA,MACF;AACA,aAAO;AAAA,IACT;AAEA,UAAM,YAAY,SAAS,MAAM;AAC/B,aAAQ,MAAM,MAAyC,IAAI,CAAC,MAAM,UAAU;AAC1E,cAAM,qBAAqB,CAAC,UAAmC;AAC7D,gBAAM,UAAU,MAAM,QAAQ,MAAM;AACpC,cAAI,OAAO,YAAY,YAAY,QAAQ,QAAQ;AACjD,mBAAO,aAAa,OAAO;AAAA,UAC7B;AAEA,gBAAM,YAAY,MAAM,aAAa,MAAM,OAAO,MAAM;AACxD,cAAI,OAAO,cAAc,YAAY,UAAU,QAAQ;AACrD,gBAAI;AACF,oBAAM,MAAM,IAAI,IAAI,SAAS;AAC7B,oBAAM,QAAQ,IAAI,SAAS,MAAM,GAAG,EAAE,OAAO,OAAO;AACpD,oBAAM,OAAO,MAAM,MAAM,SAAS,CAAC;AACnC,kBAAI,MAAM;AACR,uBAAO,aAAa,IAAI;AAAA,cAC1B;AAAA,YACF,QAAQ;AAAA,YAER;AAAA,UACF;AAEA,iBAAO;AAAA,QACT;AAEA,cAAM,eAAe,CAAC,UAAmC;AACvD,gBAAMA,SAAQ,MAAM;AACpB,cAAI,OAAOA,WAAU,SAAU,QAAOA;AACtC,cAAIA,UAAS,OAAOA,WAAU,UAAU;AACtC,kBAAM,MAAOA,OAAkC;AAC/C,kBAAM,MAAOA,OAAkC;AAC/C,gBAAI,OAAO,QAAQ,SAAU,QAAO;AACpC,gBAAI,OAAO,QAAQ,SAAU,QAAO;AAAA,UACtC;AAEA,gBAAM,WAAW,MAAM;AACvB,cAAI,OAAO,aAAa,SAAU,QAAO;AACzC,cAAI,YAAY,OAAO,aAAa,UAAU;AAC5C,kBAAM,MAAO,SAAqC;AAClD,gBAAI,OAAO,QAAQ,SAAU,QAAO;AAAA,UACtC;AAEA,gBAAM,SAAS,MAAM;AACrB,cAAI,MAAM,QAAQ,MAAM,KAAK,OAAO,SAAS,GAAG;AAC9C,kBAAM,QAAQ,OAAO,CAAC;AACtB,gBAAI,OAAO,UAAU,SAAU,QAAO;AACtC,gBAAI,SAAS,OAAO,UAAU,UAAU;AACtC,oBAAM,MAAO,MAAkC;AAC/C,kBAAI,OAAO,QAAQ,SAAU,QAAO;AAAA,YACtC;AAAA,UACF;AAEA,gBAAM,YAAY,MAAM;AACxB,cAAI,OAAO,cAAc,SAAU,QAAO;AAC1C,cAAI,aAAa,OAAO,cAAc,UAAU;AAC9C,kBAAM,MAAO,UAAsC;AACnD,gBAAI,OAAO,QAAQ,SAAU,QAAO;AAAA,UACtC;AAEA,gBAAM,WAAW,MAAM;AACvB,cAAI,OAAO,aAAa,SAAU,QAAO;AAEzC,iBAAO;AAAA,QACT;AAEA,cAAM,MAAM;AAAA,UACV,KAAK,OAAO,KAAK,YAAY,KAAK,iBAAiB,KAAK,MAAM,KAAK,cAAc;AAAA,QAAA;AAEnF,cAAM,OAAO,OAAO,KAAK,QAAQ,KAAK,SAAS,UAAU;AACzD,cAAM,WAAW,gBAAgB,KAAK,YAAY,KAAK,OAAO,GAAG,CAAC;AAClE,cAAM,QAAS,KAAK,SAAS,KAAK,QAAQ,YAAY,KAAK;AAC3D,cAAM,YAAa,KAAK,QAAQ,SAAS,KAAK,cAAc,KAAK;AAIjE,cAAM,QAAQ,aAAa,IAAI;AAE/B,cAAM,eAAe,KAAK,cAAc,KAAK,aAAa,KAAK;AAC/D,cAAM,iBAAiB,KAAK,gBAAgB,KAAK;AACjD,cAAM,YAAY,OAAO,YAAY;AACrC,cAAM,cAAc,OAAO,cAAc;AACzC,cAAM,YAAa,KAAK,aAAa,KAAK;AAE1C,eAAO;AAAA,UACL;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA,WAAW,OAAO,SAAS,SAAS,IAAI,YAAY;AAAA,UACpD,aAAa,OAAO,SAAS,WAAW,IAAI,cAAc;AAAA,UAC1D;AAAA,UACA,MAAM,mBAAmB,IAAI;AAAA,QAAA;AAAA,MAEjC,CAAC;AAAA,IACH,CAAC;AAED;AAAA,MACE;AAAA,MACA,CAAC,cAAc;AACb,kBAAU,QAAQ,CAAC,SAAS;AAC1B,qBAAW,KAAK,GAAG,IAAI,gBAAgB,KAAK,UAAU,CAAC;AAAA,QACzD,CAAC;AAAA,MACH;AAAA,MACA,EAAE,WAAW,KAAA;AAAA,IAAK;AAGG,aAAS,MAAM;AACpC,aACG,YAAY,OAAmC,mBAC/C,YAAY,OAAmC,UAAU,UAC1D;AAAA,IAEJ,CAAC;AAED,UAAM,eAAe,SAAS,MAAM;AAClC,YAAM,UAAW,YAAY,SAAqC,CAAA;AAClE,YAAM,WAAY,QAAQ,YAAwC,CAAA;AAClE,YAAM,YAAY,OAAO,SAAS,uBAAuB,SAAS,YAAY,CAAC;AAE/E,aAAO;AAAA,QACL,QAAQ,OAAO,QAAQ,mBAAmB,SAAS,UAAU,GAAG;AAAA,QAChE,kBAAkB,OAAO,SAAS,qBAAqB,GAAG;AAAA,QAC1D,mBAAmB,OAAO,SAAS,sBAAsB,GAAG;AAAA,QAC5D,gBAAgB,OAAO,SAAS,4BAA4B,SAAS,mBAAmB,MAAM;AAAA,QAC9F,WAAW,OAAO,SAAS,SAAS,IAAI,YAAY;AAAA,MAAA;AAAA,IAExD,CAAC;AAED,UAAM,gBAAgB,SAAS,MAAM;AACnC,YAAM,UAAW,YAAY,SAAqC,CAAA;AAClE,YAAM,SAAS,QAAQ;AACvB,UAAI,CAAC,OAAQ,QAAO;AACpB,YAAM,SAAS,OAAO,OAAO,MAAM,EAAE;AAAA,QACnC,CAAC,UAAU,OAAO,UAAU,YAAY,OAAO,UAAU;AAAA,MAAA;AAE3D,UAAI,OAAO,WAAW,EAAG,QAAO;AAChC,YAAM,EAAE,qBAAqB,aAAa;AAE1C,aAAO,CAAC,OAAO,KAAK,CAAC,UAAU;AAC7B,YAAI,OAAO,UAAU,iBAAiB,CAAC,OAAO,UAAU,KAAK;AAC7D,cAAM,OAAO,MAAM,KAAA;AACnB,eAAO,KAAK,SAAS,gBAAgB,KAAK,KAAK,SAAS,GAAG;AAAA,MAC7D,CAAC;AAAA,IACH,CAAC;AAED,UAAM,cAAc,CAAC,WAAoC;AACvD,UAAI,WAAW,UAAa,WAAW,KAAM,QAAO;AACpD,UAAI,OAAO,WAAW,SAAU,QAAO;AACvC,YAAM,OAAO,OAAO,KAAA;AACpB,UAAI,CAAC,KAAM,QAAO;AAElB,YAAM,EAAE,kBAAkB,mBAAmB,UAAA,IAAc,aAAa;AACxE,YAAM,iBAAiB,iBAAiB,QAAQ,uBAAuB,MAAM;AAC7E,YAAM,kBAAkB,kBAAkB,QAAQ,uBAAuB,MAAM;AAC/E,YAAM,UAAU,IAAI,OAAO,aAAa,cAAc,KAAK,eAAe,KAAK,GAAG;AAClF,UAAI,UAAU,KAAK,QAAQ,SAAS,EAAE;AAEtC,UAAI,mBAAmB;AACrB,kBAAU,QAAQ,QAAQ,IAAI,OAAO,iBAAiB,GAAG,GAAG,EAAE;AAAA,MAChE;AACA,UAAI,oBAAoB,qBAAqB,KAAK;AAChD,kBAAU,QAAQ,QAAQ,IAAI,OAAO,gBAAgB,GAAG,GAAG,GAAG;AAAA,MAChE;AAEA,YAAM,aAAa,QAAQ,SAAS,GAAG;AACvC,YAAM,UAAU,OAAO,OAAO;AAC9B,UAAI,CAAC,OAAO,SAAS,OAAO,EAAG,QAAO;AAEtC,UAAI,CAAC,cAAc,cAAc,SAAS,YAAY,GAAG;AACvD,eAAO,UAAU,KAAK,IAAI,IAAI,SAAS;AAAA,MACzC;AAEA,aAAO;AAAA,IACT;AAEA,UAAM,cAAc,CAAC,WAAoC;AACvD,YAAM,OAAO,aAAa;AAC1B,YAAM,SAAS,YAAY,MAAM;AACjC,UAAI,WAAW,KAAM,QAAO,GAAG,KAAK,MAAM;AAE1C,YAAM,aAAa,SAAS;AAC5B,YAAM,WAAW,KAAK,IAAI,MAAM;AAChC,YAAM,QAAQ,SAAS,QAAQ,KAAK,SAAS;AAC7C,YAAM,CAAC,aAAa,WAAW,IAAI,MAAM,MAAM,GAAG;AAClD,YAAM,gBAAgB,YAAY,QAAQ,yBAAyB,KAAK,iBAAiB;AACzF,YAAM,kBACJ,KAAK,YAAY,IAAI,GAAG,aAAa,GAAG,KAAK,gBAAgB,GAAG,WAAW,KAAK;AAClF,YAAM,aACJ,KAAK,mBAAmB,UAAU,GAAG,eAAe,GAAG,KAAK,MAAM,KAAK,GAAG,KAAK,MAAM,GAAG,eAAe;AAEzG,aAAO,aAAa,IAAI,UAAU,KAAK;AAAA,IACzC;AAEA,UAAM,WAAW,SAAS,MAAM;AAC9B,aACG,YAAY,OAAmC,QAAQ,YACvD,YAAY,OAAmC,YAChD;AAAA,IAEJ,CAAC;AAED,UAAM,WAAW,SAAS,MAAM;AAC9B,aACG,YAAY,OAAmC,QAAQ,aACvD,YAAY,OAAmC,aAChD;AAAA,IAEJ,CAAC;AAED,UAAM,gBAAgB,SAAS,MAAM;AACnC,aACG,YAAY,OAAmC,QAAQ,kBACvD,YAAY,OAAmC,kBAChD;AAAA,IAEJ,CAAC;AAED,UAAM,gBAAgB,SAAS,MAAM;AACnC,aACG,YAAY,OAAmC,QAAQ,kBACvD,YAAY,OAAmC,kBAChD;AAAA,IAEJ,CAAC;AAED,UAAM,aAAa,SAAS,MAAM;AAChC,aACG,YAAY,OAAmC,QAAQ,SACvD,YAAY,OAAmC,SAChD;AAAA,IAEJ,CAAC;AAWD,UAAM,cAAc,CAAC,KAAa,aAAqB;AACrD,YAAM,QAAQ,OAAO,WAAW,GAAG,CAAC;AACpC,aAAO,OAAO,SAAS,KAAK,KAAK,QAAQ,IAAI,QAAQ;AAAA,IACvD;;;;AA+BO,YAAA,OAAAC,eAAAC,WAAA,EAAA,OAAM,UAAM,MAAA,CAAA,CAAA,0BAAA;;QAED,cAAYC,MAAA,SAAA;AAAA,QAAW,cAAW;AAAA,QAAS,aAAW;AAAA,MAAA;;;QAGtD,OAAM;AAAA,QAAW,IAAG;AAAA,MAAA;yBAA9B,CAAiE,GAAAC,QAAAC,UAAA,aAAA;;;;;8BAA/B,sBAAoB;AAAA,YAAA;AAAA;;;;;UAS3CF,MAAA,OAAA,GAAO;;;;;UACPA,MAAA,KAAA,GAAK;yDAA2BA,MAAA,KAAA,CAAK,CAAA,MAAA;AAAA;;;WAClCA,MAAA,OAAA,KAAWA,MAAA,SAAA,EAAU,WAAM,GAAA;;;UAE3B,OAAM;AAAA,UAAkB,IAAG;AAAA,QAAA;2BAArC,CAAgE,GAAAC,QAAAC,UAAA,aAAA;;;;;gCAAvB,cAAY;AAAA,cAAA;AAAA;;;;;kBAEtCF,MAAA,OAAA,GAAO;;AACEG,sBAAAH,MAAA,SAAA,IAAR,SAAI;;AAGH,cAAA,KAAK,OAAK;uCAAG,OAAK,KAAK,KAAK,kBAAG,OAAK,KAAK,IAAI;;;;iGAM7CI,eAAA,KAAK,IAAI,yEAIPJ,MAAA,OAAA,CAAO,IAAA,cAAA,6EAMc,YAAY,KAAK,KAAK,CAAA,mKAQvCA,MAAA,OAAA,KAAW,YAAY,KAAK,KAAK,KAAK,QAAQ,KAAA,CAAA,IAAA,cAAA,0CAKhCI,eAAA,YAAY,KAAK,KAAK,KAAK,QAAQ,CAAA,sEAIjDJ,MAAA,OAAA,CAAO,IAAA,cAAA,iGAWfI,eAAA,YAAY,KAAK,aAAa,KAAK,KAAK,CAAA;;;;;;+IAU9CA,eAAA,YAAYJ,MAAA,QAAA,CAAQ,CAAA,wEAIlBI,eAAA,YAAYJ,MAAA,aAAA,CAAa,CAAA,kEAI3BI,eAAA,YAAYJ,MAAA,aAAA,CAAa,CAAA,sEAIzBI,eAAA,YAAYJ,MAAA,QAAA,CAAQ,CAAA,sEAIlBI,eAAA,YAAYJ,MAAA,UAAA,CAAU,CAAA;WAG1BA,MAAA,OAAA,KAAWA,MAAA,SAAA,EAAU,SAAM,GAAA;;UAClC,OAAM;AAAA,UACN,IAAG;AAAA,QAAA;2BAHL,CAMW,GAAAC,QAAAC,UAAA,aAAA;;;;;gCAFV,iBAED;AAAA,cAAA;AAAA;;;;;;;;;;;;;;;;;","names":["image","_ssrRenderAttrs","_mergeProps","_unref","_push","_parent","_ssrRenderList","_ssrInterpolate"],"sources":["../../../../pages/cart.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { storeToRefs } from \"pinia\";\nimport { useCartStore } from \"~/stores/cart\";\n\nuseHead({\n  title: \"Carrito | Smiley Punk\"\n});\n\nconst cart = useCartStore();\nconst { cart: cartPayload, items, loading, error, itemCount } = storeToRefs(cart);\n\nuseAsyncData(\"cart\", () => cart.fetchCart(), { server: false });\n\nconst quantities = reactive<Record<string, number>>({});\n\nconst resolveQuantity = (value: unknown, fallback = 1) => {\n  if (typeof value === \"number\") return Number.isFinite(value) && value > 0 ? value : fallback;\n  if (typeof value === \"string\") {\n    const parsed = Number(value);\n    return Number.isFinite(parsed) && parsed > 0 ? parsed : fallback;\n  }\n  if (value && typeof value === \"object\") {\n    const record = value as Record<string, unknown>;\n    const candidates = [record.value, record.qty, record.quantity];\n    for (const candidate of candidates) {\n      const parsed = Number(candidate);\n      if (Number.isFinite(parsed) && parsed > 0) return parsed;\n    }\n  }\n  return fallback;\n};\n\nconst cartItems = computed(() => {\n  return (items.value as Array<Record<string, unknown>>).map((item, index) => {\n    const resolveProductLink = (value: Record<string, unknown>) => {\n      const rawSlug = value.slug || value.product_slug;\n      if (typeof rawSlug === \"string\" && rawSlug.trim()) {\n        return `/products/${rawSlug}`;\n      }\n\n      const permalink = value.permalink || value.url || value.link;\n      if (typeof permalink === \"string\" && permalink.trim()) {\n        try {\n          const url = new URL(permalink);\n          const parts = url.pathname.split(\"/\").filter(Boolean);\n          const slug = parts[parts.length - 1];\n          if (slug) {\n            return `/products/${slug}`;\n          }\n        } catch {\n          // Ignore invalid URLs.\n        }\n      }\n\n      return undefined;\n    };\n\n    const resolveImage = (value: Record<string, unknown>) => {\n      const image = value.image;\n      if (typeof image === \"string\") return image;\n      if (image && typeof image === \"object\") {\n        const src = (image as Record<string, unknown>).src;\n        const url = (image as Record<string, unknown>).url;\n        if (typeof src === \"string\") return src;\n        if (typeof url === \"string\") return url;\n      }\n\n      const featured = value.featured_image;\n      if (typeof featured === \"string\") return featured;\n      if (featured && typeof featured === \"object\") {\n        const src = (featured as Record<string, unknown>).src;\n        if (typeof src === \"string\") return src;\n      }\n\n      const images = value.images;\n      if (Array.isArray(images) && images.length > 0) {\n        const first = images[0];\n        if (typeof first === \"string\") return first;\n        if (first && typeof first === \"object\") {\n          const src = (first as Record<string, unknown>).src;\n          if (typeof src === \"string\") return src;\n        }\n      }\n\n      const thumbnail = value.thumbnail;\n      if (typeof thumbnail === \"string\") return thumbnail;\n      if (thumbnail && typeof thumbnail === \"object\") {\n        const src = (thumbnail as Record<string, unknown>).src;\n        if (typeof src === \"string\") return src;\n      }\n\n      const imageUrl = value.image_url;\n      if (typeof imageUrl === \"string\") return imageUrl;\n\n      return undefined;\n    };\n\n    const key = String(\n      item.key || item.item_key || item.cart_item_key || item.id || item.product_id || index\n    );\n    const name = String(item.name || item.title || \"Producto\");\n    const quantity = resolveQuantity(item.quantity ?? item.qty ?? 1, 1);\n    const price = (item.price || item.totals?.subtotal || item.line_subtotal) as string | number | undefined;\n    const lineTotal = (item.totals?.total || item.line_total || item.line_total_raw) as\n      | string\n      | number\n      | undefined;\n    const image = resolveImage(item);\n\n    const rawProductId = item.product_id ?? item.productId ?? item.id;\n    const rawVariationId = item.variation_id ?? item.variationId;\n    const productId = Number(rawProductId);\n    const variationId = Number(rawVariationId);\n    const variation = (item.variation || item.attributes) as Record<string, unknown> | undefined;\n\n    return {\n      key,\n      name,\n      quantity,\n      price,\n      lineTotal,\n      image,\n      productId: Number.isFinite(productId) ? productId : null,\n      variationId: Number.isFinite(variationId) ? variationId : null,\n      variation,\n      link: resolveProductLink(item)\n    };\n  });\n});\n\nwatch(\n  cartItems,\n  (nextItems) => {\n    nextItems.forEach((item) => {\n      quantities[item.key] = resolveQuantity(item.quantity, 1);\n    });\n  },\n  { immediate: true }\n);\n\nconst currencySymbol = computed(() => {\n  return (\n    (cartPayload.value as Record<string, unknown>)?.currency_symbol ||\n    (cartPayload.value as Record<string, unknown>)?.currency?.symbol ||\n    \"$\"\n  );\n});\n\nconst currencyMeta = computed(() => {\n  const payload = (cartPayload.value as Record<string, unknown>) || {};\n  const currency = (payload.currency as Record<string, unknown>) || {};\n  const minorUnit = Number(currency.currency_minor_unit ?? currency.decimals ?? 2);\n\n  return {\n    symbol: String(payload.currency_symbol || currency.symbol || \"$\"),\n    decimalSeparator: String(currency.decimal_separator || \".\"),\n    thousandSeparator: String(currency.thousand_separator || \",\"),\n    symbolPosition: String(currency.currency_symbol_position || currency.symbol_position || \"left\"),\n    minorUnit: Number.isFinite(minorUnit) ? minorUnit : 2\n  };\n});\n\nconst useMinorUnits = computed(() => {\n  const payload = (cartPayload.value as Record<string, unknown>) || {};\n  const totals = payload.totals as Record<string, unknown> | undefined;\n  if (!totals) return false;\n  const values = Object.values(totals).filter(\n    (value) => typeof value === \"string\" || typeof value === \"number\"\n  );\n  if (values.length === 0) return false;\n  const { decimalSeparator } = currencyMeta.value;\n\n  return !values.some((value) => {\n    if (typeof value === \"number\") return !Number.isInteger(value);\n    const text = value.trim();\n    return text.includes(decimalSeparator) || text.includes(\".\");\n  });\n});\n\nconst parseAmount = (amount?: string | number | null) => {\n  if (amount === undefined || amount === null) return null;\n  if (typeof amount === \"number\") return amount;\n  const text = amount.trim();\n  if (!text) return null;\n\n  const { decimalSeparator, thousandSeparator, minorUnit } = currencyMeta.value;\n  const escapedDecimal = decimalSeparator.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\");\n  const escapedThousand = thousandSeparator.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\");\n  const allowed = new RegExp(`[^0-9\\\\-\\\\${escapedDecimal}\\\\${escapedThousand}]`, \"g\");\n  let cleaned = text.replace(allowed, \"\");\n\n  if (thousandSeparator) {\n    cleaned = cleaned.replace(new RegExp(escapedThousand, \"g\"), \"\");\n  }\n  if (decimalSeparator && decimalSeparator !== \".\") {\n    cleaned = cleaned.replace(new RegExp(escapedDecimal, \"g\"), \".\");\n  }\n\n  const hasDecimal = cleaned.includes(\".\");\n  const numeric = Number(cleaned);\n  if (!Number.isFinite(numeric)) return null;\n\n  if (!hasDecimal && useMinorUnits.value && minorUnit > 0) {\n    return numeric / Math.pow(10, minorUnit);\n  }\n\n  return numeric;\n};\n\nconst formatMoney = (amount?: string | number | null) => {\n  const meta = currencyMeta.value;\n  const parsed = parseAmount(amount);\n  if (parsed === null) return `${meta.symbol}0.00`;\n\n  const isNegative = parsed < 0;\n  const absolute = Math.abs(parsed);\n  const fixed = absolute.toFixed(meta.minorUnit);\n  const [integerPart, decimalPart] = fixed.split(\".\");\n  const withThousands = integerPart.replace(/\\B(?=(\\d{3})+(?!\\d))/g, meta.thousandSeparator);\n  const formattedNumber =\n    meta.minorUnit > 0 ? `${withThousands}${meta.decimalSeparator}${decimalPart}` : withThousands;\n  const withSymbol =\n    meta.symbolPosition === \"right\" ? `${formattedNumber}${meta.symbol}` : `${meta.symbol}${formattedNumber}`;\n\n  return isNegative ? `-${withSymbol}` : withSymbol;\n};\n\nconst subtotal = computed(() => {\n  return (\n    (cartPayload.value as Record<string, unknown>)?.totals?.subtotal ||\n    (cartPayload.value as Record<string, unknown>)?.subtotal ||\n    0\n  );\n});\n\nconst taxTotal = computed(() => {\n  return (\n    (cartPayload.value as Record<string, unknown>)?.totals?.total_tax ||\n    (cartPayload.value as Record<string, unknown>)?.total_tax ||\n    0\n  );\n});\n\nconst shippingTotal = computed(() => {\n  return (\n    (cartPayload.value as Record<string, unknown>)?.totals?.shipping_total ||\n    (cartPayload.value as Record<string, unknown>)?.shipping_total ||\n    0\n  );\n});\n\nconst discountTotal = computed(() => {\n  return (\n    (cartPayload.value as Record<string, unknown>)?.totals?.discount_total ||\n    (cartPayload.value as Record<string, unknown>)?.discount_total ||\n    0\n  );\n});\n\nconst orderTotal = computed(() => {\n  return (\n    (cartPayload.value as Record<string, unknown>)?.totals?.total ||\n    (cartPayload.value as Record<string, unknown>)?.total ||\n    0\n  );\n});\n\nconst updateQuantity = async (key: string) => {\n  const quantity = Number(quantities[key]);\n  if (!quantity || quantity < 1) {\n    quantities[key] = 1;\n    return;\n  }\n  await cart.updateItem(key, quantity);\n};\n\nconst getQuantity = (key: string, fallback: number) => {\n  const value = Number(quantities[key]);\n  return Number.isFinite(value) && value > 0 ? value : fallback;\n};\n\nconst changeQuantity = async (\n  item: {\n    key: string;\n    quantity: number;\n    productId: number | null;\n    variationId: number | null;\n    variation?: Record<string, unknown>;\n  },\n  delta: number\n) => {\n  const current = Number(quantities[item.key]);\n  const safeCurrent = Number.isFinite(current) && current > 0 ? current : 1;\n  const next = Math.max(1, safeCurrent + delta);\n  quantities[item.key] = next;\n\n  if (delta > 0 && item.productId) {\n    await cart.addItem(item.productId, delta, item.variationId ?? undefined, item.variation);\n    return;\n  }\n\n  await cart.updateItem(item.key, next);\n};\n\nconst removeItem = async (key: string) => {\n  await cart.removeItem(key);\n};\n</script>\n\n<template>\n  <div class=\"page\">\n    <div class=\"container\">\n      <AppHeader :item-count=\"itemCount\" cart-label=\"Items\" :cart-link=\"null\" />\n\n      <div class=\"cart-back-row\">\n        <NuxtLink class=\"pdp-back\" to=\"/\">Regresar al catalogo</NuxtLink>\n      </div>\n\n      <div class=\"cart-title-row\">\n        <h1 class=\"hero-title\">Carrito</h1>\n      </div>\n\n      <div class=\"cart-layout\">\n        <section class=\"cart-items\">\n          <p v-if=\"loading\">Cargando carrito...</p>\n          <p v-if=\"error\" class=\"hero-subtitle\">{{ error }}</p>\n          <div v-if=\"!loading && cartItems.length === 0\" class=\"cart-empty\">\n            <p>Tu carrito esta vacio.</p>\n            <NuxtLink class=\"btn btn-primary\" to=\"/\">Ver catalogo</NuxtLink>\n          </div>\n          <div v-else-if=\"!loading\" class=\"cart-list\">\n            <article v-for=\"item in cartItems\" :key=\"item.key\" class=\"cart-item\">\n              <div class=\"cart-item-media\">\n                <div class=\"cart-item-image\">\n                  <img v-if=\"item.image\" :src=\"item.image\" :alt=\"item.name\" />\n                  <span v-else>Sin imagen</span>\n                </div>\n              </div>\n              <div class=\"cart-item-body\">\n                <div class=\"cart-item-header\">\n                  <strong>{{ item.name }}</strong>\n                  <button\n                    class=\"btn-link\"\n                    type=\"button\"\n                    :disabled=\"loading\"\n                    @click=\"removeItem(item.key)\"\n                  >\n                    Quitar\n                  </button>\n                </div>\n                <p class=\"hero-subtitle\">Precio: {{ formatMoney(item.price) }}</p>\n                <div class=\"cart-item-controls\">\n                  <div class=\"qty\">\n                    <span>Cantidad</span>\n                    <div class=\"qty-controls\">\n                      <button\n                        class=\"qty-btn\"\n                        type=\"button\"\n                        :disabled=\"loading || getQuantity(item.key, item.quantity) <= 1\"\n                        @click=\"changeQuantity(item, -1)\"\n                      >\n                        -\n                      </button>\n                      <span class=\"qty-value\">{{ getQuantity(item.key, item.quantity) }}</span>\n                      <button\n                        class=\"qty-btn\"\n                        type=\"button\"\n                        :disabled=\"loading\"\n                        @click=\"changeQuantity(item, 1)\"\n                      >\n                        +\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div class=\"cart-item-total\">\n                <span>Total</span>\n                <strong>{{ formatMoney(item.lineTotal || item.price) }}</strong>\n              </div>\n            </article>\n          </div>\n        </section>\n\n        <aside class=\"cart-summary\">\n          <h2 class=\"section-title\">Resumen</h2>\n          <div class=\"summary-row\">\n            <span>Subtotal</span>\n            <span>{{ formatMoney(subtotal) }}</span>\n          </div>\n          <div class=\"summary-row\">\n            <span>Descuento</span>\n            <span>- {{ formatMoney(discountTotal) }}</span>\n          </div>\n          <div class=\"summary-row\">\n            <span>Envio</span>\n            <span>{{ formatMoney(shippingTotal) }}</span>\n          </div>\n          <div class=\"summary-row\">\n            <span>Impuestos</span>\n            <span>{{ formatMoney(taxTotal) }}</span>\n          </div>\n          <div class=\"summary-total\">\n            <span>Total</span>\n            <strong>{{ formatMoney(orderTotal) }}</strong>\n          </div>\n          <NuxtLink\n            v-if=\"!loading && cartItems.length > 0\"\n            class=\"btn btn-primary\"\n            to=\"/checkout\"\n          >\n            Ir a checkout\n          </NuxtLink>\n          <button v-else class=\"btn btn-primary\" type=\"button\" disabled>Ir a checkout</button>\n          <p class=\"hero-subtitle\">Checkout se conecta con WooCommerce via BFF.</p>\n        </aside>\n      </div>\n    </div>\n  </div>\n</template>\n"],"version":3}