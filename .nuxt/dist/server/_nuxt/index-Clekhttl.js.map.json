{"file":"index-Clekhttl.js","mappings":"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","names":["_withAsyncContext","_ssrRenderAttrs","_mergeProps","_ssrRenderComponent","_unref","_push","_parent","_createBlock","_openBlock","_ssrInterpolate","_createVNode","_toDisplayString","_ssrIncludeBooleanAttr"],"sources":["../../../../stores/catalog.ts","../../../../pages/index.vue"],"sourcesContent":["import { defineStore } from \"pinia\";\nimport type { CatalogProduct } from \"~/types/product\";\n\ninterface CatalogState {\n  items: CatalogProduct[];\n  loading: boolean;\n  error: string | null;\n}\n\nexport const useCatalogStore = defineStore(\"catalog\", {\n  state: (): CatalogState => ({\n    items: [],\n    loading: false,\n    error: null\n  }),\n  actions: {\n    async fetchProducts() {\n      if (this.items.length) {\n        return this.items;\n      }\n\n      this.loading = true;\n      this.error = null;\n\n      try {\n        const data = await $fetch<{ items: CatalogProduct[] }>(\"/api/catalog/products\");\n        this.items = data.items;\n        return this.items;\n      } catch (error) {\n        this.error = error instanceof Error ? error.message : \"Failed to load products\";\n        return [];\n      } finally {\n        this.loading = false;\n      }\n    }\n  }\n});\n","<script setup lang=\"ts\">\nimport { storeToRefs } from \"pinia\";\nimport { useCatalogStore } from \"~/stores/catalog\";\nimport { useCartStore } from \"~/stores/cart\";\n\nuseHead({\n  title: \"Smiley Punk | Playeras\"\n});\n\nconst catalog = useCatalogStore();\nconst cart = useCartStore();\nconst { items, loading, error } = storeToRefs(catalog);\nconst { itemCount, loading: cartLoading, error: cartError, items: cartItems } = storeToRefs(cart);\n\nawait useAsyncData(\"catalog-products\", () => catalog.fetchProducts());\n\nonMounted(() => {\n  cart.fetchCart();\n});\n\nconst addToCart = async (productId: number) => {\n  await cart.addItem(productId, 1);\n};\n\nconst resolveQuantity = (value: unknown, fallback = 1) => {\n  if (typeof value === \"number\") return Number.isFinite(value) && value > 0 ? value : fallback;\n  if (typeof value === \"string\") {\n    const parsed = Number(value);\n    return Number.isFinite(parsed) && parsed > 0 ? parsed : fallback;\n  }\n  if (value && typeof value === \"object\") {\n    const record = value as Record<string, unknown>;\n    const candidates = [record.value, record.qty, record.quantity];\n    for (const candidate of candidates) {\n      const parsed = Number(candidate);\n      if (Number.isFinite(parsed) && parsed > 0) return parsed;\n    }\n  }\n  return fallback;\n};\n\nconst cartLookup = computed(() => {\n  const map = new Map<\n    number,\n    { quantity: number; key?: string; variationId?: number; variation?: Record<string, unknown> }\n  >();\n  (cartItems.value as Array<Record<string, unknown>>).forEach((item, index) => {\n    const rawProductId = item.product_id ?? item.productId ?? item.id;\n    const productId = Number(rawProductId);\n    if (!Number.isFinite(productId)) return;\n\n    const quantity = resolveQuantity(item.quantity ?? item.qty ?? item.count ?? 1, 1);\n    const key = String(\n      item.key || item.item_key || item.cart_item_key || item.id || item.product_id || index\n    );\n    const rawVariationId = item.variation_id ?? item.variationId;\n    const variationId = Number(rawVariationId);\n    const variation = (item.variation || item.attributes) as Record<string, unknown> | undefined;\n\n    const entry = map.get(productId);\n    if (entry) {\n      entry.quantity += quantity;\n    } else {\n      map.set(productId, {\n        quantity,\n        key,\n        variationId: Number.isFinite(variationId) ? variationId : undefined,\n        variation\n      });\n    }\n  });\n  return map;\n});\n\nconst getCartEntry = (productId: number) => cartLookup.value.get(productId);\n\nconst changeQuantity = async (\n  productId: number,\n  entry: { quantity: number; key?: string; variationId?: number; variation?: Record<string, unknown> } | undefined,\n  delta: number\n) => {\n  if (!entry) return;\n  if (delta > 0) {\n    await cart.addItem(productId, delta, entry.variationId, entry.variation);\n    return;\n  }\n\n  const next = Math.max(0, entry.quantity + delta);\n  if (next < 1) {\n    if (entry.key) {\n      await cart.removeItem(entry.key);\n    }\n    return;\n  }\n\n  if (entry.key) {\n    await cart.updateItem(entry.key, next);\n  }\n};\n\nconst removeFromCart = async (productId: number) => {\n  const entry = getCartEntry(productId);\n  if (!entry?.key) return;\n  await cart.removeItem(entry.key);\n};\n</script>\n\n<template>\n  <div class=\"page\">\n    <div class=\"container\">\n      <AppHeader :item-count=\"itemCount\" />\n\n      <section class=\"hero\">\n        <div>\n          <span class=\"badge\">Nuevos drops</span>\n          <h1 class=\"hero-title\">Playeras que hablan fuerte</h1>\n          <p class=\"hero-subtitle\">\n            Coleccion corta, tonos clasicos y acabados limpios. Compra rapido y agrega al carrito sin salirte.\n          </p>\n          <div class=\"hero-actions\">\n            <button class=\"btn btn-primary\" type=\"button\">Ver coleccion</button>\n            <button class=\"btn btn-secondary\" type=\"button\">Como funciona</button>\n          </div>\n        </div>\n        <div class=\"hero-panel\">\n          <h3>Lo esencial en un vistazo</h3>\n          <ul>\n            <li>Stock real directo de WooCommerce</li>\n            <li>Carrito persistente con CoCart</li>\n            <li>Checkout listo para integrar</li>\n          </ul>\n        </div>\n      </section>\n\n      <section>\n        <h2 class=\"section-title\">Playeras destacadas</h2>\n        <p v-if=\"loading\">Cargando catalogo...</p>\n        <p v-else-if=\"error\">No se pudo cargar el catalogo.</p>\n        <div v-else class=\"products-grid\">\n          <article\n            v-for=\"(product, index) in items\"\n            :key=\"product.id\"\n            class=\"card\"\n            :style=\"{ animationDelay: `${index * 80}ms` }\"\n          >\n            <NuxtLink class=\"card-image\" :to=\"`/products/${product.slug}`\">\n              <img v-if=\"product.image\" :src=\"product.image\" :alt=\"product.imageAlt\" />\n              <span v-else>Sin imagen</span>\n            </NuxtLink>\n            <div class=\"card-body\">\n              <NuxtLink :to=\"`/products/${product.slug}`\">\n                <strong>{{ product.name }}</strong>\n              </NuxtLink>\n              <span class=\"price\">\n                <span v-if=\"product.salePrice\">$ {{ product.salePrice }}</span>\n                <span v-else>$ {{ product.price || product.regularPrice }}</span>\n              </span>\n              <p class=\"hero-subtitle\">{{ product.shortDescription || \"Playera clasica, lista para combinar.\" }}</p>\n              <div v-if=\"getCartEntry(product.id)\" class=\"card-qty\">\n                <span class=\"qty-label\">Cantidad</span>\n                <div class=\"card-qty-row\">\n                  <div class=\"qty-controls\">\n                    <button\n                      class=\"qty-btn\"\n                      type=\"button\"\n                      :disabled=\"cartLoading || getCartEntry(product.id).quantity <= 1\"\n                      @click=\"changeQuantity(product.id, getCartEntry(product.id), -1)\"\n                    >\n                      -\n                    </button>\n                    <span class=\"qty-value\">{{ getCartEntry(product.id).quantity }}</span>\n                    <button\n                      class=\"qty-btn\"\n                      type=\"button\"\n                      :disabled=\"cartLoading\"\n                      @click=\"changeQuantity(product.id, getCartEntry(product.id), 1)\"\n                    >\n                      +\n                    </button>\n                  </div>\n                  <button\n                    class=\"icon-btn\"\n                    type=\"button\"\n                    :disabled=\"cartLoading\"\n                    aria-label=\"Eliminar del carrito\"\n                    @click=\"removeFromCart(product.id)\"\n                  >\n                    <svg viewBox=\"0 0 24 24\" aria-hidden=\"true\">\n                      <path\n                        fill=\"currentColor\"\n                        d=\"M9 3h6l1 2h4v2H4V5h4l1-2zm1 6h2v8h-2V9zm4 0h2v8h-2V9zM7 9h2v8H7V9z\"\n                      />\n                    </svg>\n                  </button>\n                </div>\n              </div>\n              <button\n                v-else\n                class=\"btn btn-primary\"\n                type=\"button\"\n                :disabled=\"cartLoading\"\n                @click=\"addToCart(product.id)\"\n              >\n                Agregar al carrito\n              </button>\n              <p v-if=\"cartError\" class=\"hero-subtitle\">{{ cartError }}</p>\n            </div>\n          </article>\n        </div>\n      </section>\n\n      <section class=\"benefits\">\n        <div class=\"benefit\">\n          <strong>Envio rapido</strong>\n          <p class=\"hero-subtitle\">Entrega nacional con seguimiento incluido.</p>\n        </div>\n        <div class=\"benefit\">\n          <strong>Calidad premium</strong>\n          <p class=\"hero-subtitle\">Algodon suave y acabado resistente.</p>\n        </div>\n        <div class=\"benefit\">\n          <strong>Pago seguro</strong>\n          <p class=\"hero-subtitle\">Checkout directo con WooCommerce.</p>\n        </div>\n      </section>\n\n      <section class=\"footer-cta\">\n        <div>\n          <h2 class=\"section-title\">Listo para armar tu outfit?</h2>\n          <p class=\"hero-subtitle\">Explora la coleccion completa y arma tu carrito.</p>\n        </div>\n        <button class=\"btn btn-primary\" type=\"button\">Explorar playeras</button>\n      </section>\n    </div>\n  </div>\n</template>\n"],"version":3}